<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.FoodMapper">
    <select id="categoryList" resultType="hashmap">
       select * from category 
       <where>
            <if test="type == 'health'">
                categoryid BETWEEN 14 AND 22
            </if>
            <if test="type == 'disease'">
                categoryid BETWEEN 1 AND 11
            </if>
            <if test="type == 'exercise'">
                categoryid BETWEEN 50 AND 58 ORDER BY RAND()
            </if>
        </where>
    </select>
    
    <select id="foodListOfCateg" resultType="com.example.food.domain.FoodVO">
       select fc.categoryid,f.* from food_exercise_category_mapping fc,food f where fc.foodid = f.foodid and fc.categoryid =#{categoryid}
       ORDER BY RAND()
	   LIMIT 6;
    </select>
    
    <select id="myFoodList" resultType="com.example.food.domain.MyFoodVO">
       select 
       	m.foodplanid,m.userid,m.categoryid,c.name as cname,m.regdate,f.* 
       	from  
       		my_food_plan m,food f,category c 
       	where 
       		m.foodid=f.foodid and m.categoryid = c.categoryid
       		and userid = #{userid} 
       		and m.regdate =(select MAX(regdate) from my_food_plan where userid = #{userid}) 
       	limit 7;
    </select>
    
    <select id="randomMyFood" resultType="com.example.food.domain.MyFoodVO" parameterType="map">
    	select m.categoryid,c.name as cname, f.*
	    from food f, food_exercise_category_mapping m,category c 
	    where f.foodid = m.foodid and m.categoryid = c.categoryid
	    AND m.foodid > 0 and m.categoryid = 14 and f.foodid != 13
	    order by rand()
	    limit 2;
    </select>
</mapper>
